function epidemic_ETDRK4_B(N,Nfinal,dt,ckeep,L,epsilon,lambda)if nargin<7;    disp('Using default parameters');    N=512;    Nfinal=360;    dt=0.1;    ckeep=10;    L=100;    epsilon=1;    lambda=0.25;endrhside_par={lambda};x=(2*L/N)*(-N/2:N/2-1)';uv=initial(x);uvhat=fft(uv);uvkeep=zeros(N,2,1+Nfinal/ckeep);uvkeep(:,:,1)=uv;tkeep=dt*[0:ckeep:Nfinal];ksq=[((pi/L)*[0:N/2 -N/2+1:-1]').^2, epsilon*((pi/L)*[0:N/2 -N/2+1:-1]').^2];%-----------------Coefficients ----------------------------------E2=exp(-dt*ksq/2); E=exp(-dt*ksq);M = 16; % half the no. of points used in complex contour integrationr = exp(1i*pi*((1:M)-0.5)/M); % roots of 1i: (-1).^(1/(2*M))*exp(1i*[0:pi/M:pi-pi/M])for n=1:2    LR = -dt*ksq(:,n*ones(M,1)) + r(ones(N,1),:);    B21(:,n) = sum(real((exp(LR/2)-1)./LR ),2)/M;    B31(:,n) = sum(real(((LR-4).*exp(LR/2)+LR+4)./(LR.^2)),2)/M;    B32(:,n) = sum(real((4*exp(LR/2)-2*LR-4)./(LR.^2)),2)/M;    B41(:,n) = sum(real(((LR-2).*exp(LR)+LR+2)./(LR.^2)),2)/M;    B43(:,n) = sum(real((2*exp(LR)-2*LR-2)./(LR.^2)),2)/M;    C1(:,n) = sum(real((-4-LR+exp(LR).*(4-3*LR+LR.^2))./LR.^3),2)/M;    C23(:,n) = 2*sum(real((2+LR+exp(LR).*(-2+LR))./LR.^3),2)/M;    C4(:,n) = sum(real((-4-3*LR-LR.^2+exp(LR).*(4-LR))./LR.^3),2)/M;end,% The Ai equivalent would have been A1=0, A2=1/2, A3=1/2, A4=1disp('Coefficients preparation completed')%-----------------ETD Runge-Kutta----------------------------------for n=1:Nfinal,    k1=dt*fft(rhside(uv,rhside_par{:}));    uv2=real(ifft(E2.*uvhat + B21.*k1));    k2=dt*fft(rhside(uv2,rhside_par{:}));    uv3=real(ifft(E2.*uvhat + B31.*k1 + B32.*k2));    k3=dt*fft(rhside(uv3,rhside_par{:}));    uv4=real(ifft(E.*uvhat + B41.*k1 + B43.*k3));    k4=dt*fft(rhside(uv4,rhside_par{:}));    uvhat = E.*uvhat + k1.*C1 + (k2+k3).*C23 + k4.*C4;    uv=real(ifft(uvhat));    if mod(n,ckeep)==0,        uvkeep(:,:,1+n/ckeep)=uv;    end    if mod(n,10)==0,        pause(0)        disp(int2str(n))    endendsave('epidemic_ETDRK4_B.mat','tkeep','uvkeep','N','L','x')%----------------------Figures---------------------------------figure(1)plot(x,squeeze(uvkeep(:,1,:)),'g',x,squeeze(uvkeep(:,2,:)),'r')title('Solution using integrating factor')xlabel('x');ylabel('u');axis('tight')figure(2)mesh(tkeep,x,squeeze(uvkeep(:,1,:)))title('Surface plot of u')xlabel('t');ylabel('x');zlabel('z')figure(3)mesh(tkeep,x,squeeze(uvkeep(:,2,:)))title('Surface plot of v')xlabel('t');ylabel('x');zlabel('z')%--------------Initial Condition ---------------------------------function u=initial(x)u = [exp(-0.1*x.^2) ones(size(x))];%---------------Right Hand Side-----------------------------------function rhs2=rhside(u,lambda)rhs2=[u(:,1).*(u(:,2)-lambda), -u(:,1).*u(:,2)];