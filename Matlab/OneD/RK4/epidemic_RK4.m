function epidemic_RK4(N,Nfinal,dt,ckeep,L,epsilon,lambda)if nargin<7;    disp('Using default parameters');    N=512;    Nfinal=360;    dt=0.1;    ckeep=10;    L=100;    epsilon=1;    lambda=0.25;endx=(2*L/N)*(-N/2:N/2-1)';u=initial(x);uhat=fft(u);ukeep=zeros(N,2,1+Nfinal/ckeep);ukeep(:,:,1)=u;tkeep=dt*[0:ckeep:Nfinal];ksq=((pi/L)*[0:N/2 -N/2+1:-1]').^2;%-----------------Runge-Kutta----------------------------------E=[exp(-dt*ksq/2) exp(-epsilon*dt*ksq/2)]; E2=E.^2;for n=1:Nfinal    k1=dt*fft(rhside(u,lambda));    u2=real(ifft(E.*(uhat+k1/2)));    k2=dt*fft(rhside(u2,lambda));    u3=real(ifft(E.*uhat+k2/2));    k3=dt*fft(rhside(u3,lambda));    u4=real(ifft(E2.*uhat+E.*k3));    k4=dt*fft(rhside(u4,lambda));    uhat=E2.*uhat+(E2.*k1+2*E.*(k2+k3)+k4)/6;    u=real(ifft(uhat));    if mod(n,ckeep)==0,        ukeep(:,:,1+n/ckeep)=u;    endendsave('epidemic_RK4.mat','tkeep','ukeep','N','L','x')%----------------------Figures---------------------------------figure(1)plot(x,squeeze(ukeep(:,1,:)),'g',x,squeeze(ukeep(:,2,:)),'r')title('Solution using integrating factor')xlabel('x');ylabel('u');axis('tight')figure(2)mesh(tkeep,x,squeeze(ukeep(:,1,:)))title('Surface plot of u')xlabel('t');ylabel('x');zlabel('z')figure(3)mesh(tkeep,x,squeeze(ukeep(:,2,:)))title('Surface plot of v')xlabel('t');ylabel('x');zlabel('z')%--------------Initial Condition ---------------------------------function u=initial(x)u = [exp(-0.1*x.^2) ones(size(x))];%---------------Right Hand Side-----------------------------------function rhs2=rhside(u,lambda)rhs2=[u(:,1).*(u(:,2)-lambda), -u(:,1).*u(:,2)];